namespace = caudillo

# Kingmaker
caudillo.5 = {
	type = country_event
	placement = ROOT
	
	title = caudillo.5.t
	desc = caudillo.5.desc
	flavor = caudillo.5.f
	
	event_image = {
		video = "unspecific_military_parade"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/ig_icons/armed_forces.dds"
	
	duration = 3
	
	trigger = {
		# triggered by on_action
	}

	immediate = {
		ig:ig_armed_forces = {
			save_scope_as = army_scope
			leader = {
				save_scope_as = army_leader
				set_variable = caudillo_kingmaker
			}
		}
		py:conservative_party = {
			save_scope_as = conservative_party
		}
		py:liberal_party = {
			save_scope_as = liberal_party
		}
		if = {
			limit = {
				any_active_party = {
					is_party_type = communist_party
				}
			}
			py:communist_party = {
				save_scope_as = communist_party
			}
		}
		if = {
			limit = {
				any_active_party = {
					is_party_type = fascist_party
				}
			}
			py:fascist_party = {
				save_scope_as = fascist_party
			}
		}
	}
	option = { 
		name = caudillo.5.a
		default_option = yes
		if = {
			limit = {
				has_journal_entry = je_caudillo
			}
			custom_tooltip = {
				text = gain_caudillo_points
				change_variable = {
					name = caudillo_var
					add = 100
				}
			}
		}
		custom_tooltip = {
			text = armed_forces_support_conservative
			ig:ig_armed_forces = {
				leader = {
					set_variable = caudillo_conservative
				}
			}
		}
		update_party_support = yes
	}
	option = { 
		name = caudillo.5.b
		if = {
			limit = {
				has_journal_entry = je_caudillo
			}
			custom_tooltip = {
				text = gain_caudillo_points
				change_variable = {
					name = caudillo_var
					add = 100
				}
			}
		}
		custom_tooltip = {
			text = armed_forces_support_liberal
			ig:ig_armed_forces = {
				leader = {
					set_variable = caudillo_liberal
				}
			}
		}
		update_party_support = yes
	}
	option = { 
		name = caudillo.5.c
		trigger = {
			any_active_party = {
				is_party_type = communist_party
			}
			ig:ig_armed_forces = {
				leader = {
					OR = {
						has_ideology = ideology:ideology_vanguardist
						has_ideology = ideology:ideology_communist
						has_ideology = ideology:ideology_anarchist
					has_ideology = ideology:ideology_syndicalism					
					has_ideology = ideology:ideology_left_communism
					has_ideology = ideology:ideology_technocratic_socialism							
					}
				}
			}
		}
		highlighted_option = yes
		if = {
			limit = {
				has_journal_entry = je_caudillo
			}
			custom_tooltip = {
				text = gain_caudillo_points
				change_variable = {
					name = caudillo_var
					add = 100
				}
			}
		}
		custom_tooltip = {
			text = armed_forces_support_communist
			ig:ig_armed_forces = {
				leader = {
					set_variable = caudillo_communist
				}
			}
		}
		update_party_support = yes
	}
	option = { 
		name = caudillo.5.d
		trigger = {
			any_active_party = {
				is_party_type = fascist_party
			}
			ig:ig_armed_forces = {
				leader = {
					OR = {
						has_ideology = ideology:ideology_fascist
						has_ideology = ideology:ideology_ethno_nationalist
					}
				}
			}
		}
		highlighted_option = yes
		if = {
			limit = {
				has_journal_entry = je_caudillo
			}
			custom_tooltip = {
				text = gain_caudillo_points
				change_variable = {
					name = caudillo_var
					add = 100
				}
			}
		}
		custom_tooltip = {
			text = armed_forces_support_fascist
			ig:ig_armed_forces = {
				leader = {
					set_variable = caudillo_fascist
				}
			}
		}
		update_party_support = yes
	}
}